version: 2.1
jobs:
 build:
    docker:
      - image: circleci/docker:latest

    steps:
      - checkout  # Check out the code from your repository
      - setup_remote_docker:
          version: 20.10.7

      - run:
          name: Build Docker image
          command: docker build -t circlecitest .

      - run:
          name: logging in to docker account
          command: | 
            export DOCKERHUB_PASSWORD="022002Praju@9902" | docker login -u prajwals0209 -p $DOCKERHUB_PASSWORD -stdin

      - run:
          name: Push Docker image to Docker Hub
          command: |
            docker push prajwlas0209/circlecitest:latest

      - run:
          name: printing the success message 
          command: |
            echo "successfully build and pushed the image "

  # deploy:
  #   docker:
  #     - image: circleci/python:3.8  # Base image to run deployment steps
  #   steps:
  #     - checkout  # Check out the code from your repository

  #     - run:
  #         name: Install kubectl
  #         command: |
  #           curl -LO "https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl"
  #           chmod +x ./kubectl
  #           sudo mv ./kubectl /usr/local/bin/kubectl

  #     - run:
  #         name: Configure kubectl
  #         command: |
  #           mkdir -p $HOME/.kube
  #           echo $KUBECONFIG_CONTENT > $HOME/.kube/config

  #     - run:
  #         name: Deploy to Kubernetes
  #         command: kubectl apply -f k8s/deployment.yaml

workflows:
  build_and_deploy:
    jobs:
      - build
      # - deploy:
      #     requires:
      #       - build
